<div class="chat-container">
  <!-- Chat Rooms List -->
  <mat-card class="chat-rooms">
    <mat-card-header>
      <mat-card-title>Chats</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-list>
        <mat-list-item
          *ngFor="let room of chatRooms"
          [class.active]="currentChatRoom?.id === room.id"
          (click)="selectChatRoom(room)"
        >
          <div class="chat-room-item">
            <span>{{ room.name }}</span>
            <small *ngIf="room.lastMessage">
              {{ room.lastMessage.content | slice:0:30 }}...
            </small>
          </div>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>

  <!-- Chat Messages -->
  <mat-card class="chat-messages" *ngIf="currentChatRoom">
    <mat-card-header>
      <mat-card-title>{{ currentChatRoom.name }}</mat-card-title>
      <mat-card-subtitle *ngIf="currentChatRoom.type === 'group'">
        {{ currentChatRoom.participants.length }} participants
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content #messageContainer class="message-container">
      <div class="messages">
        <div
          *ngFor="let message of messages"
          [class.own-message]="message.senderId === currentUserId"
          class="message-bubble"
        >
          <div class="message-content">
            <small class="sender-name" *ngIf="currentChatRoom.type === 'group'">
              {{ getSenderName(message.senderId) }}
            </small>
            <p>{{ message.content }}</p>
            <small class="timestamp">
              {{ message.timestamp | date:'short' }}
            </small>
          </div>
        </div>
      </div>
    </mat-card-content>

    <mat-card-actions>
      <div class="message-input">
        <mat-form-field appearance="outline" class="full-width">
          <input
            matInput
            [(ngModel)]="newMessage"
            placeholder="Type a message..."
            (keyup.enter)="sendMessage()"
          >
        </mat-form-field>
        <button
          mat-icon-button
          color="primary"
          (click)="sendMessage()"
          [disabled]="!newMessage.trim()"
        >
          <mat-icon>send</mat-icon>
        </button>
      </div>
    </mat-card-actions>
  </mat-card>
</div>